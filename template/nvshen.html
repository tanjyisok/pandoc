<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"$if(lang)$ lang="$lang$" xml:lang="$lang$"$endif$>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
$for(author-meta)$
  <meta name="author" content="$author-meta$" />
$endfor$
$if(date-meta)$
  <meta name="date" content="$date-meta$" />
$endif$
  <title>$if(title-prefix)$$title-prefix$ - $endif$$pagetitle$</title>
  <style type="text/css">code{white-space: pre;}</style>
$if(quotes)$
  <style type="text/css">q { quotes: "“" "”" "‘" "’"; }</style>
$endif$
$if(highlighting-css)$
  <style type="text/css">
$highlighting-css$
  </style>
$endif$
$for(css)$
  <link rel="stylesheet" href="$css$" $if(html5)$$else$type="text/css" $endif$/>
$endfor$
$if(math)$
  $math$
$endif$
$for(header-includes)$
  $header-includes$
$endfor$
</head>
<body>
<div id="feixun">
	<img id="feixunpic" src="../res/feixun.jpg"></img>
</div>
<div id="title"></div>
<div id="hst">版本历史</div>
<div id="history"></div>
$for(include-before)$
$include-before$
$endfor$
$if(title)$
<div id="$idprefix$header">
<h1 class="title">$title$</h1>
$if(subtitle)$
<h1 class="subtitle">$subtitle$</h1>
$endif$
$for(author)$
<h2 class="author">$author$</h2>
$endfor$
$if(date)$
<h3 class="date">$date$</h3>
$endif$
</div>
$endif$
$if(toc)$
<span id="navtoggle" onclick="navToggle()"><a>☰</a></span>
<div id="TOC">
<div id="TOC_NAV" class="sidenav">

</div>
<h1>目录</h1>
<div id="$idprefix$TOC_CONTENT">
$toc$
</div>
</div>
$endif$
<div id="$idprefix$main">
$body$
</div>
$for(include-after)$
$include-after$
$endfor$


<div id="myModal" class="modal">

    <!-- The Close Button -->
    <span class="close" onclick="document.getElementById('myModal').style.display='none'">&times;</span>
	
    <!-- Modal Content (The Image) -->
    <canvas id="c1"> <!--宽高写在html里，写在css里有问题-->
        <span>该浏览器不支持canvas内容</span> <!--对于不支持canvas的浏览器显示-->
    </canvas>

    <!-- Modal Caption (Image Text) -->
    <div id="caption"></div>
</div>

</body>

<script src="../js/classie.js"></script>
<script src="../js/main.js"></script>

<script type="text/javascript">
//设置标题和版本历史
document.getElementById("title").innerHTML=document.title;
t=document.getElementsByTagName("table");
h=document.getElementById("history");
h.innerHTML=t[0].outerHTML;
t[1].remove();

//目录链接
var $$ = function (selector) {
    var cl, id, alls, arrEle = [];
    if (/^\./.test(selector)) {
        cl = selector.replace(".", "");
        alls = document.getElementsByTagName("*"), l = alls.length;
        for (var i=0; i<l; i+=1) {
            var name = alls[i].className, arrName = [];
            if (name) {
                arrName = name.split(" "), lName = arrName.length;
                for (var j=0; j<lName; j+=1) {
                    if (arrName[j] === cl) {
                        arrEle.push(alls[i]);
                    }
                }
            }
        }
    } else if (/^#/.test(selector)) {
        id = selector.replace("#", "");
        var o = document.getElementById(id);
        if (o) {
            arrEle.push(o);
        }
    }
    return arrEle;
};
Array.prototype.click = function(fn) {
    var l = this.length;
    if (l) {
        for (var i=0; i<l; i+=1) {
            this[i].onclick = function() {
                fn.call(this);
            };
        }
    }
};
$$(".acco_title").click(function() {
    var rel = this.lang, cl = this.className;
    if (!/on/.test(cl) && rel) {
        $$("#" + rel)[0].style.height = "100%";
        this.className = "acco_title acco_title_on";
    }

    if (/on/.test(cl) && rel) {
        $$("#" + rel)[0].style.height = "0";
        this.className = "acco_title";
    }
});

function openheader(obj) {
    var name = obj? obj.innerHTML: undefined;
    if (name) {
        name = name.substring(name.indexOf("</span>") + 8, name.length);
        name = name.toLowerCase();
    } else {
        console.log("name is null");
        return;
    }

    var target = document.getElementById(name);
    if (target) {
        var tag = target.tagName.toLowerCase();
        if (tag.indexOf("h3") >= 0) {
            target = target.parentNode.previousSibling;
        } else {
            target = target.parentNode;
        }

        if (target && target.className && target.className.indexOf("acco_title") >= 0) {
            target.click();
        }

        target = target.parentNode.previousSibling;
        if (target && target.className && target.className.indexOf("acco_title") >= 0) {
            target.click();
        }
    }
}

var links = document.getElementsByTagName("a");
for (var i = 0; i < links.length; i++) {
    links[i].onclick = function(){ openheader(this) };
}

//侧边栏
toc_content=document.getElementById("TOC_CONTENT");
toc_nav=document.getElementById("TOC_NAV");
toc=document.getElementById("TOC");
toc_nav.innerHTML=toc_content.innerHTML;
toc.remove();

var nav_opened
function navToggle() {
    if (nav_opened == 1) {
        document.getElementById("TOC_NAV").style.width = "0";
        document.getElementById("body").style.marginLeft = "0";
        nav_opened = 0;
    } else {
        document.getElementById("TOC_NAV").style.width = "250px";
        document.getElementById("body").style.marginLeft = "250px";
        nav_opened = 1;
    }
}

//图片点击显示设置
// Get the modal
var modal = document.getElementById('myModal');

// Get the image and insert it inside the modal - use its "alt" text as a caption
var img = document.getElementsByTagName('img');
var modalImg = document.getElementById("img01");
var captionText = document.getElementById("caption");
for(i=1;i<img.length;i++){


img[i].onclick = function(){
    modal.style.display = "block";
    var oC = document.getElementById("c1");
    var oCG = oC.getContext("2d");

    //设置canvas宽高适应图片宽高
    var w=this.width;
    var h=this.height;
    oC.width=w;
    oC.height=h;

    oCG.drawImage(this, 0, 0);
    //modalImg.src = this.src;
    captionText.innerHTML = this.alt;

    oC.onmousedown = function(ev) {
    var ev = ev || window.event;
    oCG.moveTo(ev.clientX-oC.offsetLeft,ev.clientY-oC.offsetTop); //ev.clientX-oC.offsetLeft,ev.clientY-oC.offsetTop鼠标在当前画布上X,Y坐标
    console.log(ev.clientX-oC.offsetLeft,ev.clientY-oC.offsetTop);
    oC.onmousemove = function(ev) {
        var ev = ev || window.event;//获取event对象
        oCG.strokeStyle="#FF0000";
        oCG.lineWidth=5;
        oCG.lineTo(ev.clientX-oC.offsetLeft,ev.clientY-oC.offsetTop);
        oCG.stroke();
        };
    oC.onmouseup = function() {
        oC.onmousemove = null;
        oC.onmouseup = null;
        };
    oC.onmouseout = function(){
        oC.onmousemove = null;
        oC.onmouseup = null;
    }
　　};
}
}

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on <span> (x), close the modal
span.onclick = function() { 
  modal.style.display = "none";
}

</script>
</html>
